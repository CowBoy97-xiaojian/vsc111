1、加载maven-jar包到mavne仓库
mvn install:install-file -DgroupId=org.lionsoul -DartifactId=ip2region -Dversion=1.0 -Dpackaging=jar -Dfile=F:\Users\19406\Desktop\工作\2、数据开发\5、flink程序开发\1、seatunel有关的java函数\ip2region-maker-1.0.jar

2、seatunnel最新sql

select 
accountId as project_id,
eventKey as event_key,
stm_udf(eventTime) as event_time,
eventType as event_type,
stm_udf(clientTime) as client_time,
anonymousUser as anonymous_user,
replace(userId,'\n','') as user,
userKey as user_key,
session,
packageName as package,
attr_get_udf(attributes,'$platform') as platform,
attr_get_udf(attributes,'$referrer_domain') as referrer_domain,
ua_all_udf(attributes) as browser,
'' as browser_version,
'' as os,
'' as os_version,
attr_get_udf(attributes,'$client_version') as client_version,
attr_get_udf(attributes,'$channel') as channel,
'' as device_brand,
'' as device_model,
attr_get_udf(attributes,'$device_type') as device_type,
attr_get_udf(attributes,'$device_orientation') as device_orientation,
attr_get_udf(attributes,'$language') as language,accountId as account_id,
attr_get_udf(attributes,'$domain') as domain,
ip_udf(attributes,'$ip') as ip,
attr_get_udf(attributes,'$user_agent') as user_agent,
attr_get_udf(attributes,'$sdk_version') as sdk_version,
locationLatitude as location_latitude,
locationLongitude as location_longitude,
attr_get_udf(attributes,'$data_source_id') as data_source_id,
esId as esid,
attr_remove_udf(attributes) as attributes,
dt_udf(eventTime) as dt,
hour_udf(eventTime) as hour 


from kafka_data



{"accountId":"9e4e5fa7244c6b6e","anonymousUser":"a5e0e0b1-92dd-4e9d-8d47-7db65014da41","attributes":{"$data_source_id":"a7464be8b200fe24","$index":"0","$os":"web","$platform":"web","$ip":"2409:8a00:264f:d5b0:23b5:e828:d938:336e","WT_event":"H5PageShow","$device_orientation":"PORTRAIT","$user_agent":"Mozilla/5.0 (Linux; Android 12; ELS-AN00 Build/HUAWEIELS-AN00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/99.0.4844.88 Mobile Safari/537.36 leadeon/9.9.0/CMCCIT","$language":"zh-CN","WT_prov":"100","WT_envName":"","WT_clientID":"Ac3elAP8ZcjTQUlgJ5CVF2Mm618OxEi44dqE7exSzzGHELn6dUQLhGyrrXsC9j9D6VXdu2jSH74lEGXHLgNx7A==","WT_userBrand":"01","$client_version":"1.0.0","WT_cid":"Ac3elAP8ZcjTQUlgJ5CVF2Mm618OxEi44dqE7exSzzGHELn6dUQLhGyrrXsC9j9D6VXdu2jSH74lEGXHLgNx7A==","WT_et":"pageview","WT_loginProvince":"100","WT_es":"https://h5.bj.10086.cn/cmcc_app/cmcc-bjapp/index.html#/new-package-zone?channelId=P00000052494&yx=1096102001","$path":"/cmcc_app/cmcc-bjapp/index.html#/new-package-zone","WT_next_url":"","$sdk_version":"3.8.3","WT_city":"010","$title":"新套餐专区","$query":"channelId=P00000052494&yx=1096102001","WT_loginCity":"010","$domain":"h5.bj.10086.cn"},"clientTime":1712487135283,"esId":38,"eventKey":"pageview","eventTime":1712487135353,"eventType":"CUSTOM_EVENT","locationLatitude":0.0,"locationLongitude":0.0,"packageName":"","session":"7196d749-73b9-4cc4-a9b7-eb7cb678c010","userId":"mTunsbvQyOCpIbvrZpMTSA==","userKey":"$basic_userId"}
{"accountId":"9e4e5fa7244c6b6e","anonymousUser":"9535fd50-47db-4087-be75-2c92cb32b22f","attributes":{"$data_source_id":"a7464be8b200fe24","WT_goods_id":"","WT_mc_ev":"210315_QYCS_100","$index":"0","$os":"web","XY_channelname":"中国移动APP_5月0元合约B001","XY_point_position":"立即领取","$platform":"web","$ip":"114.246.236.224","XY_pageid":"0015","WT_event":"plusThird--立即领取","$device_orientation":"PORTRAIT","XY_environment":"production","$user_agent":"Mozilla/5.0 (Linux; Android 10; Mi 10 Build/QKQ1.191117.002; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/83.0.4103.101 Mobile Safari/537.36 leadeon/9.9.0/CMCCIT","XY_prepare1":"","$language":"zh-CN","WT_prov":"北京市","WT_envName":"","WT_clientID":"Ac3elAP8ZcjTQUlgJ5CVF1Cz0fSRyyFwj2E6DIDGscW7g2S4Rsks6VnWjmtrWEObIKC6wZ7Xkc73OaGm33euOA==","WT_userBrand":"09","XY_member":"Plus会员18元档-黄金会员","XY_login_status":"1","$client_version":"1.0.0","WT_cid":"Ac3elAP8ZcjTQUlgJ5CVF1Cz0fSRyyFwj2E6DIDGscW7g2S4Rsks6VnWjmtrWEObIKC6wZ7Xkc73OaGm33euOA==","WT_et":"clk","WT_loginProvince":"100","$path":"/rights-front/dist/index.html#/plusThird","XY_module_no":"plusThird-通信特权","WT_next_url":"","$sdk_version":"3.8.3","XY_userId":"178****6787","WT_city":"北京市","XY_current_pagename":"兑换类详情页","WT_sku_id":"","$title":"中国移动权益超市","WT_channelid":"BJYDJTAPP001_B001","XY_current_url":"plusThird/goodDetail","$referrer_domain":"https://xcxp.bj.10086.cn/rights-front/dist/index.html#/plusThird?mudel=mod1&pageType=Plus","$query":"mudel=mod1","WT_loginCity":"010","XY_module_name":"通信特权","$domain":"xcxp.bj.10086.cn","XY_component_id":""},"clientTime":1712487132546,"esId":151,"eventKey":"clk","eventTime":1712487134913,"eventType":"CUSTOM_EVENT","locationLatitude":0.0,"locationLongitude":0.0,"packageName":"","session":"f08cd2d1-a146-4d5c-8d70-70410382e94d","userId":"17801716787","userKey":"$basic_userId"}
{"accountId":"9e4e5fa7244c6b6e","anonymousUser":"bebc0162-9698-4890-ac50-7debd3b51974","attributes":{"$data_source_id":"a7464be8b200fe24","$index":"0","$os":"web","$platform":"web","$ip":"2408:8207:11:c6a0:891a:c23f:4194:ef4e","XY_wxid":"wxid_1712487135277_46946_17354","WT_event":"tbd_send","$device_orientation":"PORTRAIT","$user_agent":"Mozilla/5.0 (Linux; Android 13; 2209129SC Build/TKQ1.220829.002; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/104.0.5112.97 Mobile Safari/537.36 leadeon/9.9.0/CMCCIT","$language":"zh-CN","WT_prov":"","WT_clientID":"Ac3elAP8ZcjTQUlgJ5CVF30RMKvOzox2S6GVjg8q83zbnfY4f8GBnPLxmFzSE4mdxax7VRtXAsdy9S74rHeChw==","WT_tbd":"49575","WT_userBrand":"09","$client_version":"1.0.0","WT_cid":"Ac3elAP8ZcjTQUlgJ5CVF30RMKvOzox2S6GVjg8q83zbnfY4f8GBnPLxmFzSE4mdxax7VRtXAsdy9S74rHeChw==","WT_et":"pageview","WT_loginProvince":"100","$path":"/cmcc_vact/task-tree/index.html#/index","$sdk_version":"3.8.3","WT_city":"010","XY_wxerr":"[2002]","$title":"月月赢流量","$referrer_domain":"https://h5.bj.10086.cn/cmcc_vact/task-tree/index.html?channelId=P00000054333&yx=1074377001#/","$query":"channelId=P00000054333&yx=1074377001","WT_loginCity":"010","$domain":"h5.bj.10086.cn"},"clientTime":1712487135288,"esId":279,"eventKey":"pageview","eventTime":1712487135343,"eventType":"CUSTOM_EVENT","locationLatitude":0.0,"locationLongitude":0.0,"packageName":"","session":"2e984ee2-cf53-4d3c-ac83-b33b9a125d3d","userId":"lp9pEfZLSqFf+9rBfRvDMg==","userKey":"$basic_userId"}
{"accountId":"9e4e5fa7244c6b6e","anonymousUser":"4bf7e9a7-a6c4-4e5e-8737-2f094a7d5b49","attributes":{"$data_source_id":"a7464be8b200fe24","$path":"/rights-front/dist/index.html#/oss/cmcc","$index":"0","$os":"web","$sdk_version":"3.8.3","$platform":"web","$ip":"117.11.14.42","$device_orientation":"PORTRAIT","$user_agent":"Mozilla/5.0 (Linux; Android 13; 22041211AC Build/TP1A.220624.014; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/104.0.5112.97 Mobile Safari/537.36 leadeon/9.9.0/CMCCIT","$language":"zh-CN","$title":"中国移动权益超市","$query":"retailerCode=BJYDJTAPP001&sonRetailerCode=Y9018&channelId=P00000054176&yx=1073552001","$client_version":"1.0.0","$domain":"xcxp.bj.10086.cn"},"clientTime":1712487134553,"esId":1,"eventKey":"","eventTime":1712487135203,"eventType":"PAGE","locationLatitude":0.0,"locationLongitude":0.0,"packageName":"","session":"36f5c529-227a-4e70-89ce-a8424ee68f8c","userId":"","userKey":"$anonymous_user"}
{"accountId":"9e4e5fa7244c6b6e","anonymousUser":"15d336f8-49d3-43a2-9be3-6d96ddbef95f","attributes":{"$data_source_id":"a7464be8b200fe24","$index":"0","$os":"web","$platform":"web","$ip":"2409:8900:672f:5504:449:dcff:feb2:9fab","XY_wxid":"wxid_1712487134816_49175_44000","WT_event":"P00000023206","$device_orientation":"PORTRAIT","$user_agent":"Mozilla/5.0 (Linux; Android 14; 23013RK75C Build/UKQ1.230804.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/118.0.0.0 Mobile Safari/537.36 leadeon/9.9.0/CMCCIT","$language":"en-US","WT_prov":"","WT_envName":"中国移动APP养小树活动页_任务","WT_clientID":"Ac3elAP8ZcjTQUlgJ5CVF1OVe4q+Z1PlC+5KGKC6jBQrS2xqsMoopaKS8Tj3XmKFzlwDtBdagQ86asN+l5F+wQ==","WT_userBrand":"09","$client_version":"1.0.0","WT_cid":"Ac3elAP8ZcjTQUlgJ5CVF1OVe4q+Z1PlC+5KGKC6jBQrS2xqsMoopaKS8Tj3XmKFzlwDtBdagQ86asN+l5F+wQ==","WT_et":"clk","WT_loginProvince":"100","WT_es":"https://h5.bj.10086.cn/cmcc_vact/task-tree/index.html#/","$path":"/cmcc_vact/task-tree/index.html#/index","$sdk_version":"3.8.3","WT_city":"010","XY_wxerr":"[2002]","$title":"月月赢流量","$referrer_domain":"https://h5.bj.10086.cn/cmcc_vact/task-tree/index.html#/stealing/index","WT_loginCity":"010","$domain":"h5.bj.10086.cn"},"clientTime":1712487134830,"esId":55,"eventKey":"clk","eventTime":1712487135342,"eventType":"CUSTOM_EVENT","locationLatitude":0.0,"locationLongitude":0.0,"packageName":"","session":"1a0efedf-7084-4772-96fc-93e98d34fb42","userId":"NtaTC1TxIVbn+PsyaPdxjw==","userKey":"$basic_userId"}
{"accountId":"9e4e5fa7244c6b6e","anonymousUser":"c78cdfd0-5775-401f-8b5e-8212ee9a6923","attributes":{"$data_source_id":"a7464be8b200fe24","$path":"/rights-front/dist/index.html#/oss/cmcc","$index":"0","$os":"web","$sdk_version":"3.8.3","$platform":"web","$ip":"2409:8a00:609d:c710:3daf:5b81:eba6:b145","$device_orientation":"PORTRAIT","$user_agent":"Mozilla/5.0 (Linux; Android 10; YAL-AL10 Build/HUAWEIYAL-AL10; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/83.0.4103.106 Mobile Safari/537.36 leadeon/9.9.0/CMCCIT","$language":"zh-CN","$title":"中国移动权益超市","$query":"retailerCode=BJYDJTAPP001&sonRetailerCode=Y9018&channelId=P00000054176&yx=1073552001","$client_version":"1.0.0","$domain":"xcxp.bj.10086.cn"},"clientTime":1712487134781,"esId":4,"eventKey":"","eventTime":1712487135212,"eventType":"PAGE","locationLatitude":0.0,"locationLongitude":0.0,"packageName":"","session":"0fdba4ef-831b-4f4b-b99f-bd44c9643871","userId":"+/F8Ld8j4dBIBgFtANI4IA==","userKey":"$basic_userId"}
{"accountId":"9e4e5fa7244c6b6e","anonymousUser":"6838a196-3d6d-4cb7-91e4-41cd38ff16d5","attributes":{"$data_source_id":"a7464be8b200fe24","$path":"/cmcc_app/checkin/index.html#/index","$index":"0","$os":"web","$sdk_version":"3.8.3","$platform":"web","$ip":"2409:8900:7bc3:3c1b:8dfd:719:a1cd:d373","$device_orientation":"PORTRAIT","$user_agent":"Mozilla/5.0 (Linux; Android 12; EBG-AN00 Build/HUAWEIEBG-AN00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/99.0.4844.88 Mobile Safari/537.36 leadeon/9.9.0/CMCCIT","$language":"zh-CN","$title":"签到赢好礼","$client_version":"1.0.0","$domain":"h5.bj.10086.cn"},"clientTime":1712487133875,"esId":9,"eventKey":"","eventTime":1712487135304,"eventType":"PAGE","locationLatitude":0.0,"locationLongitude":0.0,"packageName":"","session":"31557de8-ed3a-4dde-8740-50fdca5d30cb","userId":"rioRROWIXO1bZkcX70qCWg==","userKey":"$basic_userId"}
{"accountId":"9e4e5fa7244c6b6e","anonymousUser":"d4281985-6b80-4348-9d3c-0f47b516c867","attributes":{"$data_source_id":"a7464be8b200fe24","$path":"/cmcc_activity/2023/act85/index.html#/","$index":"0","$os":"web","$sdk_version":"3.8.3","$platform":"web","$ip":"60.253.185.67","$device_orientation":"PORTRAIT","$user_agent":"Mozilla/5.0 (Linux; Android 12; LIO-AL00 Build/HUAWEILIO-AL00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/99.0.4844.88 Mobile Safari/537.36 leadeon/9.9.0/CMCCIT","$language":"zh-CN","$title":"国安专区","$referrer_domain":"https://h5.bj.10086.cn/cmcc_activity/2023/act85/index.html?channel=JT&yx=1138354001&channelId=P00000055892","$query":"channel=JT&yx=1138354001&channelId=P00000055892","$client_version":"1.0.0","$domain":"h5.bj.10086.cn"},"clientTime":1712487135374,"esId":7,"eventKey":"","eventTime":1712487135079,"eventType":"PAGE","locationLatitude":0.0,"locationLongitude":0.0,"packageName":"","session":"19acb578-4581-41b2-86e9-8b6e9286760c","userId":"2xCAgZjkdOVR3yrpQpwn7A==","userKey":"$basic_userId"}
{"accountId":"9e4e5fa7244c6b6e","anonymousUser":"f8481166-974d-4d3d-9db9-769975a48279","attributes":{"$data_source_id":"a7464be8b200fe24","WT_goods_id":"QY1622624839221","WT_mc_ev":"210315_QYCS_100","$index":"0","$os":"web","XY_channelname":"北京移动短信_Plus成功挂尾-0316","XY_point_position":"立即兑换按钮","$platform":"web","$ip":"2409:8934:4e8f:824f:5d:6f2d:9d9f:3f42","XY_pageid":"0003","WT_event":"plusThird--立即兑换按钮","$device_orientation":"PORTRAIT","XY_environment":"production","$user_agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 16_1_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Mobile/15E148 Safari/604.1","XY_prepare1":"","$language":"zh-CN","WT_prov":"","WT_envName":"","WT_clientID":"","WT_userBrand":"","XY_member":"黄金会员","XY_login_status":"1","$client_version":"1.0.0","WT_cid":"983805411545157632020-1782248635bj0600010000000000","WT_et":"clk","WT_loginProvince":"100","$path":"/rights-front/dist/index.html#/plusThird","XY_module_no":"plusThird-权益福袋","WT_next_url":"/plusThird/goodDetail","$sdk_version":"3.8.3","XY_userId":"137****7421","WT_city":"","XY_current_pagename":"会员页-Plus","WT_sku_id":"","$title":"中国移动权益超市","WT_channelid":"BJYDDX001_B009","XY_current_url":"plusThird","$referrer_domain":"https://xcxp.bmcc.com.cn/rights-front/dist/index.html#/plusThird/shopCarDetail","$query":"mudel=mod1&pageType=Plus","WT_loginCity":"010","XY_module_name":"权益福袋","$domain":"xcxp.bmcc.com.cn","XY_component_id":""},"clientTime":1712487134833,"esId":7,"eventKey":"clk","eventTime":1712487135126,"eventType":"CUSTOM_EVENT","locationLatitude":0.0,"locationLongitude":0.0,"packageName":"","session":"382e9fd0-f74f-4749-8398-e18084ea899c","userId":"13718887421","userKey":"$basic_userId"}
{"accountId":"9e4e5fa7244c6b6e","anonymousUser":"baf23e74-3bdd-4597-a5b1-256b0a3423fd","attributes":{"$data_source_id":"a7464be8b200fe24","$index":"0","$os":"web","$platform":"web","$ip":"111.193.17.28","XY_wxid":"wxid_1712487135066_41695_36794","WT_event":"P00000023203","$device_orientation":"PORTRAIT","$user_agent":"Mozilla/5.0 (Linux; Android 10; JSN-AL00a Build/HONORJSN-AL00a; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/80.0.3987.99 Mobile Safari/537.36 leadeon/8.5.0/CMCCIT","$language":"zh-CN","WT_prov":"","WT_envName":"中国移动APP养小树活动页_任务_查看视频彩铃钻石会员年包_领取","WT_clientID":"+tnaQrwX8/XgxlcdUZxtTlAxtItOZ4M7CMOV4RZJ7mcwaet7c0WeoYOaMY+GAv28sJlSRCipoQIyeEkM21s9aQUvRGBDQycgg4cG8R3a1RK5RlENqTgODd1fhJC7Xfn3l3uK78WRsUQ=","WT_userBrand":"09","$client_version":"1.0.0","WT_cid":"+tnaQrwX8/XgxlcdUZxtTlAxtItOZ4M7CMOV4RZJ7mcwaet7c0WeoYOaMY+GAv28sJlSRCipoQIyeEkM21s9aQUvRGBDQycgg4cG8R3a1RK5RlENqTgODd1fhJC7Xfn3l3uK78WRsUQ=","WT_et":"clk","WT_loginProvince":"100","WT_es":"https://h5.bj.10086.cn/cmcc_vact/task-tree/index.html#/","$path":"/cmcc_vact/task-tree/index.html#/index","$sdk_version":"3.8.3","WT_city":"010","XY_wxerr":"[2002]","$title":"月月赢流量","$referrer_domain":"https://h5.bj.10086.cn/cmcc_vact/task-tree/index.html#/","WT_loginCity":"010","$domain":"h5.bj.10086.cn"},"clientTime":1712487135100,"esId":135,"eventKey":"clk","eventTime":1712487135141,"eventType":"CUSTOM_EVENT","locationLatitude":0.0,"locationLongitude":0.0,"packageName":"","session":"d99a58b6-e50d-4962-8563-8e470f7b9ac1","userId":"DfDppUxSZWWcDq47BRd4Rg==","userKey":"$basic_userId"}



