CREATE TABLE `ham_jituan.data_job_monitoring`(
  `interface_name` string COMMENT '接口名称', 
  `start_time` string COMMENT '开始时间', 
  `end_time` string COMMENT '结束时间', 
  `file_count` string COMMENT '文件数', 
  `total_lines` string COMMENT '文件总行数', 
  `total_data_sum` string COMMENT '数据库总数据量', 
  `data_consistency` string COMMENT '数据是否一致', 
  `job_status` string COMMENT ' 运行状态')
PARTITIONED BY ( 
  `dt` string, 
  `hour` string, 
  `job_name` string)
ROW FORMAT SERDE 
  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' 
STORED AS INPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
LOCATION
  'hdfs://udbachdp1/user/hive/warehouse/ham_jituan.db/data_job_monitoring'
TBLPROPERTIES (
  'EXTERNAL'='FALSE', 
  'last_modified_by'='udbac', 
  'last_modified_time'='1693377003', 
  'transient_lastDdlTime'='1694742549')


  `total_lines` string COMMENT '文件总行数', 
select dt,start_time,end_time,file_count,total_lines 
from ham_jituan.data_job_monitoring 
where
dt='2023-12-28'; and  job_name = 'transform_51007_daily';

--查询推送数据
select *
from ham_jituan.data_job_monitoring 
where
dt in ('2023-12-26','2023-12-27','2023-12-28')
and hour ='23'
and  job_name = 'transform_51007_daily';



51007,2023-12-18 00:56:25,2023-12-18 01:17:20,1670,1315738631,1315738631,true,运行完毕,2023-12-17,23,transform_51007_daily

data_job_monitoring.interface_name,data_job_monitoring.start_time,data_job_monitoring.end_time,data_job_monitoring.file_count,data_job_monitoring.total_lines,data_job_monitoring.total_data_sum,data_job_monitoring.data_consistency,data_job_monitoring.job_status,data_job_monitoring.dt,data_job_monitoring.hour,data_job_monitoring.job_name
51007,2023-12-17 01:41:47,2023-12-17 01:54:20,26,20031362,20031362,true,运行完毕,2023-12-17,00,export_51007_gio_hourly
51007,2023-12-17 01:42:16,2023-12-17 01:54:19,27,21107881,21107881,true,运行完毕,2023-12-17,00,export_51007_hourly
51007,2023-12-17 02:50:09,2023-12-17 02:56:41,14,10563985,10563985,true,运行完毕,2023-12-17,01,export_51007_gio_hourly
51007,2023-12-17 02:55:19,2023-12-17 03:01:40,14,11138270,11138270,true,运行完毕,2023-12-17,01,export_51007_hourly
51007,2023-12-17 03:34:56,2023-12-17 03:39:09,9,6462071,6462071,true,运行完毕,2023-12-17,02,export_51007_gio_hourly
51007,2023-12-17 03:37:43,2023-12-17 03:42:09,9,6916247,6916247,true,运行完毕,2023-12-17,02,export_51007_hourly
51007,2023-12-17 04:33:40,2023-12-17 04:37:14,6,4714187,4714187,true,运行完毕,2023-12-17,03,export_51007_gio_hourly
51007,2023-12-17 04:34:58,2023-12-17 04:38:52,7,5375062,5375062,true,运行完毕,2023-12-17,03,export_51007_hourly
51007,2023-12-17 05:33:17,2023-12-17 05:36:51,6,4566789,4566789,true,运行完毕,2023-12-17,04,export_51007_gio_hourly
51007,2023-12-17 05:30:15,2023-12-17 05:34:09,8,5637711,5637711,true,运行完毕,2023-12-17,04,export_51007_hourly
51007,2023-12-17 06:33:38,2023-12-17 06:38:19,9,7080395,7080395,true,运行完毕,2023-12-17,05,export_51007_gio_hourly
51007,2023-12-17 06:35:23,2023-12-17 06:41:37,12,9536841,9536841,true,运行完毕,2023-12-17,05,export_51007_hourly
51007,2023-12-17 07:37:29,2023-12-17 07:45:10,17,13126975,13126975,true,运行完毕,2023-12-17,06,export_51007_gio_hourly
51007,2023-12-17 07:39:50,2023-12-17 07:49:47,23,17841373,17841373,true,运行完毕,2023-12-17,06,export_51007_hourly
51007,2023-12-17 08:42:34,2023-12-17 08:55:16,29,23199538,23199538,true,运行完毕,2023-12-17,07,export_51007_gio_hourly
51007,2023-12-17 08:43:06,2023-12-17 08:59:12,38,29603363,29603363,true,运行完毕,2023-12-17,07,export_51007_hourly
51007,2023-12-17 09:44:34,2023-12-17 10:01:57,42,32982172,32982172,true,运行完毕,2023-12-17,08,export_51007_gio_hourly
51007,2023-12-17 09:38:16,2023-12-17 09:58:58,51,40284275,40284275,true,运行完毕,2023-12-17,08,export_51007_hourly
51007,2023-12-17 10:47:43,2023-12-17 11:08:22,47,37483011,37483011,true,运行完毕,2023-12-17,09,export_51007_gio_hourly
51007,2023-12-17 10:37:47,2023-12-17 11:00:48,57,44959594,44959594,true,运行完毕,2023-12-17,09,export_51007_hourly
51007,2023-12-17 11:46:00,2023-12-17 12:06:00,48,38088083,38088083,true,运行完毕,2023-12-17,10,export_51007_gio_hourly
51007,2023-12-17 11:38:39,2023-12-17 12:02:15,58,46157157,46157157,true,运行完毕,2023-12-17,10,export_51007_hourly
51007,2023-12-17 12:47:34,2023-12-17 13:07:48,47,36954733,36954733,true,运行完毕,2023-12-17,11,export_51007_gio_hourly
51007,2023-12-17 12:42:52,2023-12-17 13:06:24,57,45031679,45031679,true,运行完毕,2023-12-17,11,export_51007_hourly
51007,2023-12-17 13:45:47,2023-12-17 14:03:48,44,34603124,34603124,true,运行完毕,2023-12-17,12,export_51007_gio_hourly
51007,2023-12-17 13:47:35,2023-12-17 14:09:28,54,42501936,42501936,true,运行完毕,2023-12-17,12,export_51007_hourly
51007,2023-12-17 14:44:01,2023-12-17 15:00:18,39,31095566,31095566,true,运行完毕,2023-12-17,13,export_51007_gio_hourly
51007,2023-12-17 14:38:53,2023-12-17 14:58:06,48,37840697,37840697,true,运行完毕,2023-12-17,13,export_51007_hourly
51007,2023-12-17 15:44:26,2023-12-17 16:02:51,39,30781589,30781589,true,运行完毕,2023-12-17,14,export_51007_gio_hourly
51007,2023-12-17 15:42:37,2023-12-17 16:03:33,48,37668266,37668266,true,运行完毕,2023-12-17,14,export_51007_hourly
51007,2023-12-17 16:44:30,2023-12-17 17:00:48,39,30807071,30807071,true,运行完毕,2023-12-17,15,export_51007_gio_hourly
51007,2023-12-17 16:43:03,2023-12-17 17:03:44,48,38204332,38204332,true,运行完毕,2023-12-17,15,export_51007_hourly
51007,2023-12-17 17:45:15,2023-12-17 18:01:46,39,30599926,30599926,true,运行完毕,2023-12-17,16,export_51007_gio_hourly
51007,2023-12-17 17:40:44,2023-12-17 18:00:21,48,38297461,38297461,true,运行完毕,2023-12-17,16,export_51007_hourly
51007,2023-12-17 18:43:51,2023-12-17 19:00:09,38,30241945,30241945,true,运行完毕,2023-12-17,17,export_51007_gio_hourly
51007,2023-12-17 18:38:48,2023-12-17 18:58:02,48,37672952,37672952,true,运行完毕,2023-12-17,17,export_51007_hourly
51007,2023-12-17 19:44:15,2023-12-17 20:00:35,37,29588194,29588194,true,运行完毕,2023-12-17,18,export_51007_gio_hourly
51007,2023-12-17 19:39:11,2023-12-17 19:58:13,47,37199682,37199682,true,运行完毕,2023-12-17,18,export_51007_hourly
51007,2023-12-17 20:47:03,2023-12-17 21:03:16,38,30079450,30079450,true,运行完毕,2023-12-17,19,export_51007_gio_hourly
51007,2023-12-17 20:38:50,2023-12-17 20:57:56,47,37469240,37469240,true,运行完毕,2023-12-17,19,export_51007_hourly
51007,2023-12-17 21:43:33,2023-12-17 22:00:09,38,29962043,29962043,true,运行完毕,2023-12-17,20,export_51007_gio_hourly
51007,2023-12-17 21:38:14,2023-12-17 21:57:35,46,36791512,36791512,true,运行完毕,2023-12-17,20,export_51007_hourly
51007,2023-12-17 22:45:33,2023-12-17 23:02:03,38,29769033,29769033,true,运行完毕,2023-12-17,21,export_51007_gio_hourly
51007,2023-12-17 22:41:25,2023-12-17 22:59:49,45,35465791,35465791,true,运行完毕,2023-12-17,21,export_51007_hourly
51007,2023-12-17 23:46:05,2023-12-18 00:01:19,36,28615641,28615641,true,运行完毕,2023-12-17,22,export_51007_gio_hourly
51007,2023-12-17 23:39:41,2023-12-17 23:56:34,42,33072734,33072734,true,运行完毕,2023-12-17,22,export_51007_hourly
51007,2023-12-18 00:42:50,2023-12-18 00:55:17,29,22814479,22814479,true,运行完毕,2023-12-17,23,export_51007_gio_hourly
51007,2023-12-18 00:39:59,2023-12-18 00:53:59,33,25753213,25753213,true,运行完毕,2023-12-17,23,export_51007_hourly
51007,2023-12-18 01:17:57,2023-12-18 01:41:08,,,,,运行完毕,2023-12-17,23,push_51007_daily
51007,2023-12-18 00:56:25,2023-12-18 01:17:20,1670,1315738631,1315738631,true,运行完毕,2023-12-17,23,transform_51007_daily